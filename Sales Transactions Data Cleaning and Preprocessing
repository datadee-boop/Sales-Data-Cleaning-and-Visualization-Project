{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>M</td>\n",
       "      <td>34.0</td>\n",
       "      <td>electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>jane smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>clothing</td>\n",
       "      <td>three</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-12-03</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.5</td>\n",
       "      <td>15.5</td>\n",
       "      <td>01-12-2024</td>\n",
       "      <td>pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>F</td>\n",
       "      <td>45.0</td>\n",
       "      <td>kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120</td>\n",
       "      <td>0</td>\n",
       "      <td>12/01/2024</td>\n",
       "      <td>cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>F</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299</td>\n",
       "      <td>299</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>110.0</td>\n",
       "      <td>2024-13-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.0</td>\n",
       "      <td>five hundred</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>john doe</td>\n",
       "      <td>M</td>\n",
       "      <td>34.0</td>\n",
       "      <td>ELECTRONICS</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>F</td>\n",
       "      <td>30.0</td>\n",
       "      <td>electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299.00</td>\n",
       "      <td>299.0</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category Quantity  \\\n",
       "0         1      John Doe       M  34.0      electronics        2   \n",
       "1         2    jane smith  Female  28.0         clothing    three   \n",
       "2         3           Sam    male   NaN           beauty        1   \n",
       "3         4           Ali       F  45.0          kitchen        0   \n",
       "4         5         Carla       F  30.0      Electronics        1   \n",
       "5         6          Mike    Male  39.0         Clothing        2   \n",
       "6         7           Zoe  Female  27.0         clothing        1   \n",
       "7         8           Tom    male  31.0      Electronics        1   \n",
       "8         9      john doe       M  34.0      ELECTRONICS        2   \n",
       "9        10        Carla       F   30.0      electronics        1   \n",
       "\n",
       "  Price_Per_Unit   Total_Price Purchase_Date Delivery_Status  \\\n",
       "0        $499.99        999.98    2024/12/01       delivered   \n",
       "1          39.99           NaN    2024-12-03       Delivered   \n",
       "2           15.5          15.5    01-12-2024         pending   \n",
       "3            120             0    12/01/2024       cancelled   \n",
       "4           $299           299    2024.12.01       Delivered   \n",
       "5             55         110.0    2024-13-01       delivered   \n",
       "6          29.99         29.99    2024-12-01       delivered   \n",
       "7          500.0  five hundred    2024/12/01       delivered   \n",
       "8        $499.99        999.98    2024/12/01       Delivered   \n",
       "9        $299.00         299.0    2024.12.01       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from dateutil import parser\n",
    "\n",
    "df = pd.read_csv('/Users/danon/Downloads/messy_sales_data.csv')\n",
    "\n",
    "df\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>M</td>\n",
       "      <td>34.0</td>\n",
       "      <td>electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>jane smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>clothing</td>\n",
       "      <td>three</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-12-03</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.5</td>\n",
       "      <td>15.5</td>\n",
       "      <td>01-12-2024</td>\n",
       "      <td>pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>F</td>\n",
       "      <td>45.0</td>\n",
       "      <td>kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120</td>\n",
       "      <td>0</td>\n",
       "      <td>12/01/2024</td>\n",
       "      <td>cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>F</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299</td>\n",
       "      <td>299</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>110.0</td>\n",
       "      <td>2024-13-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.0</td>\n",
       "      <td>five hundred</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>john doe</td>\n",
       "      <td>M</td>\n",
       "      <td>34.0</td>\n",
       "      <td>ELECTRONICS</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>F</td>\n",
       "      <td>30.0</td>\n",
       "      <td>electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299.00</td>\n",
       "      <td>299.0</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category Quantity  \\\n",
       "0         1      John Doe       M  34.0      electronics        2   \n",
       "1         2    jane smith  Female  28.0         clothing    three   \n",
       "2         3           Sam    male   NaN           beauty        1   \n",
       "3         4           Ali       F  45.0          kitchen        0   \n",
       "4         5         Carla       F  30.0      Electronics        1   \n",
       "5         6          Mike    Male  39.0         Clothing        2   \n",
       "6         7           Zoe  Female  27.0         clothing        1   \n",
       "7         8           Tom    male  31.0      Electronics        1   \n",
       "8         9      john doe       M  34.0      ELECTRONICS        2   \n",
       "9        10        Carla       F   30.0      electronics        1   \n",
       "\n",
       "  Price_Per_Unit   Total_Price Purchase_Date Delivery_Status  \\\n",
       "0        $499.99        999.98    2024/12/01       delivered   \n",
       "1          39.99           NaN    2024-12-03       Delivered   \n",
       "2           15.5          15.5    01-12-2024         pending   \n",
       "3            120             0    12/01/2024       cancelled   \n",
       "4           $299           299    2024.12.01       Delivered   \n",
       "5             55         110.0    2024-13-01       delivered   \n",
       "6          29.99         29.99    2024-12-01       delivered   \n",
       "7          500.0  five hundred    2024/12/01       delivered   \n",
       "8        $499.99        999.98    2024/12/01       Delivered   \n",
       "9        $299.00         299.0    2024.12.01       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# STEP 1 \n",
    "\n",
    "# Make a copy of dataframe, which will be used for cleaning\n",
    "\n",
    "df_clean= df.copy()\n",
    "df_clean\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>M</td>\n",
       "      <td>34.0</td>\n",
       "      <td>electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>clothing</td>\n",
       "      <td>three</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-12-03</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.5</td>\n",
       "      <td>15.5</td>\n",
       "      <td>01-12-2024</td>\n",
       "      <td>pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>F</td>\n",
       "      <td>45.0</td>\n",
       "      <td>kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120</td>\n",
       "      <td>0</td>\n",
       "      <td>12/01/2024</td>\n",
       "      <td>cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>F</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299</td>\n",
       "      <td>299</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>110.0</td>\n",
       "      <td>2024-13-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.0</td>\n",
       "      <td>five hundred</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>M</td>\n",
       "      <td>34.0</td>\n",
       "      <td>ELECTRONICS</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>F</td>\n",
       "      <td>30.0</td>\n",
       "      <td>electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299.00</td>\n",
       "      <td>299.0</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category Quantity  \\\n",
       "0         1      John Doe       M  34.0      electronics        2   \n",
       "1         2    Jane Smith  Female  28.0         clothing    three   \n",
       "2         3           Sam    male   NaN           beauty        1   \n",
       "3         4           Ali       F  45.0          kitchen        0   \n",
       "4         5         Carla       F  30.0      Electronics        1   \n",
       "5         6          Mike    Male  39.0         Clothing        2   \n",
       "6         7           Zoe  Female  27.0         clothing        1   \n",
       "7         8           Tom    male  31.0      Electronics        1   \n",
       "8         9      John Doe       M  34.0      ELECTRONICS        2   \n",
       "9        10         Carla      F   30.0      electronics        1   \n",
       "\n",
       "  Price_Per_Unit   Total_Price Purchase_Date Delivery_Status  \\\n",
       "0        $499.99        999.98    2024/12/01       delivered   \n",
       "1          39.99           NaN    2024-12-03       Delivered   \n",
       "2           15.5          15.5    01-12-2024         pending   \n",
       "3            120             0    12/01/2024       cancelled   \n",
       "4           $299           299    2024.12.01       Delivered   \n",
       "5             55         110.0    2024-13-01       delivered   \n",
       "6          29.99         29.99    2024-12-01       delivered   \n",
       "7          500.0  five hundred    2024/12/01       delivered   \n",
       "8        $499.99        999.98    2024/12/01       Delivered   \n",
       "9        $299.00         299.0    2024.12.01       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# STEP 2\n",
    "\n",
    "# Normalize Customer_Name column\n",
    "\n",
    "\n",
    "def clean_name(name):\n",
    "    if pd.isnull(name):\n",
    "        return name\n",
    "    name = ' '.join(word.capitalize() for word in str(name).strip().split())\n",
    "\n",
    "    return name\n",
    "\n",
    "df_clean['Customer_Name'] = df_clean['Customer_Name'].apply(clean_name)\n",
    "df_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>clothing</td>\n",
       "      <td>three</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-12-03</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>Male</td>\n",
       "      <td>NaN</td>\n",
       "      <td>beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.5</td>\n",
       "      <td>15.5</td>\n",
       "      <td>01-12-2024</td>\n",
       "      <td>pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>Female</td>\n",
       "      <td>45.0</td>\n",
       "      <td>kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120</td>\n",
       "      <td>0</td>\n",
       "      <td>12/01/2024</td>\n",
       "      <td>cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299</td>\n",
       "      <td>299</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>110.0</td>\n",
       "      <td>2024-13-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.0</td>\n",
       "      <td>five hundred</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>ELECTRONICS</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299.00</td>\n",
       "      <td>299.0</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category Quantity  \\\n",
       "0         1      John Doe    Male  34.0      electronics        2   \n",
       "1         2    Jane Smith  Female  28.0         clothing    three   \n",
       "2         3           Sam    Male   NaN           beauty        1   \n",
       "3         4           Ali  Female  45.0          kitchen        0   \n",
       "4         5         Carla  Female  30.0      Electronics        1   \n",
       "5         6          Mike    Male  39.0         Clothing        2   \n",
       "6         7           Zoe  Female  27.0         clothing        1   \n",
       "7         8           Tom    Male  31.0      Electronics        1   \n",
       "8         9      John Doe    Male  34.0      ELECTRONICS        2   \n",
       "9        10         Carla  Female  30.0      electronics        1   \n",
       "\n",
       "  Price_Per_Unit   Total_Price Purchase_Date Delivery_Status  \\\n",
       "0        $499.99        999.98    2024/12/01       delivered   \n",
       "1          39.99           NaN    2024-12-03       Delivered   \n",
       "2           15.5          15.5    01-12-2024         pending   \n",
       "3            120             0    12/01/2024       cancelled   \n",
       "4           $299           299    2024.12.01       Delivered   \n",
       "5             55         110.0    2024-13-01       delivered   \n",
       "6          29.99         29.99    2024-12-01       delivered   \n",
       "7          500.0  five hundred    2024/12/01       delivered   \n",
       "8        $499.99        999.98    2024/12/01       Delivered   \n",
       "9        $299.00         299.0    2024.12.01       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# STEP 3\n",
    "\n",
    "# Normalize Gender column\n",
    "\n",
    "def clean_gender(g):\n",
    "    g = str(g).strip().lower()\n",
    "    if g in ['m', 'male']:\n",
    "        return 'Male'\n",
    "    elif g in ['f', 'female']:\n",
    "        return 'Female'\n",
    "    else:\n",
    "        return 'Other'\n",
    "\n",
    "df_clean['Gender'] = df_clean['Gender'].apply(clean_gender)\n",
    "df_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>clothing</td>\n",
       "      <td>three</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-12-03</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.5</td>\n",
       "      <td>15.5</td>\n",
       "      <td>01-12-2024</td>\n",
       "      <td>pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>Female</td>\n",
       "      <td>45.0</td>\n",
       "      <td>kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120</td>\n",
       "      <td>0</td>\n",
       "      <td>12/01/2024</td>\n",
       "      <td>cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299</td>\n",
       "      <td>299</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>110.0</td>\n",
       "      <td>2024-13-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.0</td>\n",
       "      <td>five hundred</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>ELECTRONICS</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299.00</td>\n",
       "      <td>299.0</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category Quantity  \\\n",
       "0         1      John Doe    Male  34.0      electronics        2   \n",
       "1         2    Jane Smith  Female  28.0         clothing    three   \n",
       "2         3           Sam    Male  31.0           beauty        1   \n",
       "3         4           Ali  Female  45.0          kitchen        0   \n",
       "4         5         Carla  Female  30.0      Electronics        1   \n",
       "5         6          Mike    Male  39.0         Clothing        2   \n",
       "6         7           Zoe  Female  27.0         clothing        1   \n",
       "7         8           Tom    Male  31.0      Electronics        1   \n",
       "8         9      John Doe    Male  34.0      ELECTRONICS        2   \n",
       "9        10         Carla  Female  30.0      electronics        1   \n",
       "\n",
       "  Price_Per_Unit   Total_Price Purchase_Date Delivery_Status  \\\n",
       "0        $499.99        999.98    2024/12/01       delivered   \n",
       "1          39.99           NaN    2024-12-03       Delivered   \n",
       "2           15.5          15.5    01-12-2024         pending   \n",
       "3            120             0    12/01/2024       cancelled   \n",
       "4           $299           299    2024.12.01       Delivered   \n",
       "5             55         110.0    2024-13-01       delivered   \n",
       "6          29.99         29.99    2024-12-01       delivered   \n",
       "7          500.0  five hundred    2024/12/01       delivered   \n",
       "8        $499.99        999.98    2024/12/01       Delivered   \n",
       "9        $299.00         299.0    2024.12.01       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#STEP 4\n",
    "\n",
    "# Fill in NaN with the median value for Age\n",
    "\n",
    "df_clean = df_clean.fillna(df_clean.median(numeric_only=True))\n",
    "df_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>three</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-12-03</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.5</td>\n",
       "      <td>15.5</td>\n",
       "      <td>01-12-2024</td>\n",
       "      <td>pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>Female</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120</td>\n",
       "      <td>0</td>\n",
       "      <td>12/01/2024</td>\n",
       "      <td>cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299</td>\n",
       "      <td>299</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>110.0</td>\n",
       "      <td>2024-13-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.0</td>\n",
       "      <td>five hundred</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299.00</td>\n",
       "      <td>299.0</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category Quantity  \\\n",
       "0         1      John Doe    Male  34.0      Electronics        2   \n",
       "1         2    Jane Smith  Female  28.0         Clothing    three   \n",
       "2         3           Sam    Male  31.0           Beauty        1   \n",
       "3         4           Ali  Female  45.0          Kitchen        0   \n",
       "4         5         Carla  Female  30.0      Electronics        1   \n",
       "5         6          Mike    Male  39.0         Clothing        2   \n",
       "6         7           Zoe  Female  27.0         Clothing        1   \n",
       "7         8           Tom    Male  31.0      Electronics        1   \n",
       "8         9      John Doe    Male  34.0      Electronics        2   \n",
       "9        10         Carla  Female  30.0      Electronics        1   \n",
       "\n",
       "  Price_Per_Unit   Total_Price Purchase_Date Delivery_Status  \\\n",
       "0        $499.99        999.98    2024/12/01       delivered   \n",
       "1          39.99           NaN    2024-12-03       Delivered   \n",
       "2           15.5          15.5    01-12-2024         pending   \n",
       "3            120             0    12/01/2024       cancelled   \n",
       "4           $299           299    2024.12.01       Delivered   \n",
       "5             55         110.0    2024-13-01       delivered   \n",
       "6          29.99         29.99    2024-12-01       delivered   \n",
       "7          500.0  five hundred    2024/12/01       delivered   \n",
       "8        $499.99        999.98    2024/12/01       Delivered   \n",
       "9        $299.00         299.0    2024.12.01       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#STEP 5\n",
    "\n",
    "# Normalize Product_Category Column\n",
    "\n",
    "\n",
    "df_clean['Product_Category'] = df_clean['Product_Category'].str.strip().str.lower().str.capitalize()\n",
    "df_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>3</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-12-03</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.5</td>\n",
       "      <td>15.5</td>\n",
       "      <td>01-12-2024</td>\n",
       "      <td>pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>Female</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120</td>\n",
       "      <td>0</td>\n",
       "      <td>12/01/2024</td>\n",
       "      <td>cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299</td>\n",
       "      <td>299</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55</td>\n",
       "      <td>110.0</td>\n",
       "      <td>2024-13-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.0</td>\n",
       "      <td>five hundred</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>$499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>$299.00</td>\n",
       "      <td>299.0</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category  Quantity  \\\n",
       "0         1      John Doe    Male  34.0      Electronics         2   \n",
       "1         2    Jane Smith  Female  28.0         Clothing         3   \n",
       "2         3           Sam    Male  31.0           Beauty         1   \n",
       "3         4           Ali  Female  45.0          Kitchen         0   \n",
       "4         5         Carla  Female  30.0      Electronics         1   \n",
       "5         6          Mike    Male  39.0         Clothing         2   \n",
       "6         7           Zoe  Female  27.0         Clothing         1   \n",
       "7         8           Tom    Male  31.0      Electronics         1   \n",
       "8         9      John Doe    Male  34.0      Electronics         2   \n",
       "9        10         Carla  Female  30.0      Electronics         1   \n",
       "\n",
       "  Price_Per_Unit   Total_Price Purchase_Date Delivery_Status  \\\n",
       "0        $499.99        999.98    2024/12/01       delivered   \n",
       "1          39.99           NaN    2024-12-03       Delivered   \n",
       "2           15.5          15.5    01-12-2024         pending   \n",
       "3            120             0    12/01/2024       cancelled   \n",
       "4           $299           299    2024.12.01       Delivered   \n",
       "5             55         110.0    2024-13-01       delivered   \n",
       "6          29.99         29.99    2024-12-01       delivered   \n",
       "7          500.0  five hundred    2024/12/01       delivered   \n",
       "8        $499.99        999.98    2024/12/01       Delivered   \n",
       "9        $299.00         299.0    2024.12.01       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# STEP 6\n",
    "\n",
    "# Normalize Quantity\n",
    "\n",
    "def clean_quantity(q):\n",
    "\n",
    "    if q =='three':\n",
    "        return 3\n",
    "\n",
    "    try:\n",
    "        return int(q)\n",
    "    except ValueError:\n",
    "        return np.nan\n",
    "\n",
    "df_clean['Quantity'] = df_clean['Quantity'].apply(clean_quantity)\n",
    "df_clean\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>3</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-12-03</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.50</td>\n",
       "      <td>15.5</td>\n",
       "      <td>01-12-2024</td>\n",
       "      <td>pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>Female</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120.00</td>\n",
       "      <td>0</td>\n",
       "      <td>12/01/2024</td>\n",
       "      <td>cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55.00</td>\n",
       "      <td>110.0</td>\n",
       "      <td>2024-13-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.00</td>\n",
       "      <td>five hundred</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.0</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category  Quantity  \\\n",
       "0         1      John Doe    Male  34.0      Electronics         2   \n",
       "1         2    Jane Smith  Female  28.0         Clothing         3   \n",
       "2         3           Sam    Male  31.0           Beauty         1   \n",
       "3         4           Ali  Female  45.0          Kitchen         0   \n",
       "4         5         Carla  Female  30.0      Electronics         1   \n",
       "5         6          Mike    Male  39.0         Clothing         2   \n",
       "6         7           Zoe  Female  27.0         Clothing         1   \n",
       "7         8           Tom    Male  31.0      Electronics         1   \n",
       "8         9      John Doe    Male  34.0      Electronics         2   \n",
       "9        10         Carla  Female  30.0      Electronics         1   \n",
       "\n",
       "   Price_Per_Unit   Total_Price Purchase_Date Delivery_Status  \\\n",
       "0          499.99        999.98    2024/12/01       delivered   \n",
       "1           39.99           NaN    2024-12-03       Delivered   \n",
       "2           15.50          15.5    01-12-2024         pending   \n",
       "3          120.00             0    12/01/2024       cancelled   \n",
       "4          299.00           299    2024.12.01       Delivered   \n",
       "5           55.00         110.0    2024-13-01       delivered   \n",
       "6           29.99         29.99    2024-12-01       delivered   \n",
       "7          500.00  five hundred    2024/12/01       delivered   \n",
       "8          499.99        999.98    2024/12/01       Delivered   \n",
       "9          299.00         299.0    2024.12.01       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#STEP 7\n",
    "\n",
    "# Normalize Price per Unit column\n",
    "\n",
    "def clean_ppu(p):\n",
    "    p = str(p).strip().replace('$', '')\n",
    "\n",
    "    try:\n",
    "        return float(p)\n",
    "    except ValueError:\n",
    "        return np.nan\n",
    "\n",
    "df_clean['Price_Per_Unit'] = df_clean['Price_Per_Unit'].apply(clean_ppu)\n",
    "df_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>3</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-12-03</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.50</td>\n",
       "      <td>15.50</td>\n",
       "      <td>01-12-2024</td>\n",
       "      <td>pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>Female</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>12/01/2024</td>\n",
       "      <td>cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55.00</td>\n",
       "      <td>110.00</td>\n",
       "      <td>2024-13-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.00</td>\n",
       "      <td>500.00</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024/12/01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024.12.01</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category  Quantity  \\\n",
       "0         1      John Doe    Male  34.0      Electronics         2   \n",
       "1         2    Jane Smith  Female  28.0         Clothing         3   \n",
       "2         3           Sam    Male  31.0           Beauty         1   \n",
       "3         4           Ali  Female  45.0          Kitchen         0   \n",
       "4         5         Carla  Female  30.0      Electronics         1   \n",
       "5         6          Mike    Male  39.0         Clothing         2   \n",
       "6         7           Zoe  Female  27.0         Clothing         1   \n",
       "7         8           Tom    Male  31.0      Electronics         1   \n",
       "8         9      John Doe    Male  34.0      Electronics         2   \n",
       "9        10         Carla  Female  30.0      Electronics         1   \n",
       "\n",
       "   Price_Per_Unit  Total_Price Purchase_Date Delivery_Status  \\\n",
       "0          499.99       999.98    2024/12/01       delivered   \n",
       "1           39.99          NaN    2024-12-03       Delivered   \n",
       "2           15.50        15.50    01-12-2024         pending   \n",
       "3          120.00         0.00    12/01/2024       cancelled   \n",
       "4          299.00       299.00    2024.12.01       Delivered   \n",
       "5           55.00       110.00    2024-13-01       delivered   \n",
       "6           29.99        29.99    2024-12-01       delivered   \n",
       "7          500.00       500.00    2024/12/01       delivered   \n",
       "8          499.99       999.98    2024/12/01       Delivered   \n",
       "9          299.00       299.00    2024.12.01       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#STEP 8\n",
    "\n",
    "# Normalize Total Price column\n",
    "\n",
    "def clean_totalp (t):\n",
    "    t = str(t).strip().lower()\n",
    "    if t == 'five hundred':\n",
    "        return 500\n",
    "    try:\n",
    "        return float(t)\n",
    "    except ValueError:\n",
    "        return np.nan\n",
    "\n",
    "df_clean['Total_Price'] = df_clean['Total_Price'].apply(clean_totalp) \n",
    "df_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>3</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-03-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.50</td>\n",
       "      <td>15.50</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>Female</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55.00</td>\n",
       "      <td>110.00</td>\n",
       "      <td>2024-01-13</td>\n",
       "      <td>delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.00</td>\n",
       "      <td>500.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category  Quantity  \\\n",
       "0         1      John Doe    Male  34.0      Electronics         2   \n",
       "1         2    Jane Smith  Female  28.0         Clothing         3   \n",
       "2         3           Sam    Male  31.0           Beauty         1   \n",
       "3         4           Ali  Female  45.0          Kitchen         0   \n",
       "4         5         Carla  Female  30.0      Electronics         1   \n",
       "5         6          Mike    Male  39.0         Clothing         2   \n",
       "6         7           Zoe  Female  27.0         Clothing         1   \n",
       "7         8           Tom    Male  31.0      Electronics         1   \n",
       "8         9      John Doe    Male  34.0      Electronics         2   \n",
       "9        10         Carla  Female  30.0      Electronics         1   \n",
       "\n",
       "   Price_Per_Unit  Total_Price Purchase_Date Delivery_Status  \\\n",
       "0          499.99       999.98    2024-01-12       delivered   \n",
       "1           39.99          NaN    2024-03-12       Delivered   \n",
       "2           15.50        15.50    2024-12-01         pending   \n",
       "3          120.00         0.00    2024-01-12       cancelled   \n",
       "4          299.00       299.00    2024-01-12       Delivered   \n",
       "5           55.00       110.00    2024-01-13       delivered   \n",
       "6           29.99        29.99    2024-01-12       delivered   \n",
       "7          500.00       500.00    2024-01-12       delivered   \n",
       "8          499.99       999.98    2024-01-12       Delivered   \n",
       "9          299.00       299.00    2024-01-12       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#STEP 9\n",
    "\n",
    "# Normalise Purchase Date column\n",
    "\n",
    "def clean_date(date):\n",
    "    if pd.isnull(date):\n",
    "        return np.NaT\n",
    "\n",
    "    return parser.parse(str(date), dayfirst=True, fuzzy=True).date()\n",
    "\n",
    "    \n",
    "df_clean['Purchase_Date'] = df_clean['Purchase_Date'].apply(clean_date)\n",
    "df_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>3</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-03-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.50</td>\n",
       "      <td>15.50</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>Pending</td>\n",
       "      <td>sam@domain</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>Female</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55.00</td>\n",
       "      <td>110.00</td>\n",
       "      <td>2024-01-13</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>mike_at_email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.00</td>\n",
       "      <td>500.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>tom.email.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>john.doe@gmail</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category  Quantity  \\\n",
       "0         1      John Doe    Male  34.0      Electronics         2   \n",
       "1         2    Jane Smith  Female  28.0         Clothing         3   \n",
       "2         3           Sam    Male  31.0           Beauty         1   \n",
       "3         4           Ali  Female  45.0          Kitchen         0   \n",
       "4         5         Carla  Female  30.0      Electronics         1   \n",
       "5         6          Mike    Male  39.0         Clothing         2   \n",
       "6         7           Zoe  Female  27.0         Clothing         1   \n",
       "7         8           Tom    Male  31.0      Electronics         1   \n",
       "8         9      John Doe    Male  34.0      Electronics         2   \n",
       "9        10         Carla  Female  30.0      Electronics         1   \n",
       "\n",
       "   Price_Per_Unit  Total_Price Purchase_Date Delivery_Status  \\\n",
       "0          499.99       999.98    2024-01-12       Delivered   \n",
       "1           39.99          NaN    2024-03-12       Delivered   \n",
       "2           15.50        15.50    2024-12-01         Pending   \n",
       "3          120.00         0.00    2024-01-12       Cancelled   \n",
       "4          299.00       299.00    2024-01-12       Delivered   \n",
       "5           55.00       110.00    2024-01-13       Delivered   \n",
       "6           29.99        29.99    2024-01-12       Delivered   \n",
       "7          500.00       500.00    2024-01-12       Delivered   \n",
       "8          499.99       999.98    2024-01-12       Delivered   \n",
       "9          299.00       299.00    2024-01-12       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0       john.doe@gmail  \n",
       "1  jane.smith@mail.com  \n",
       "2           sam@domain  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5    mike_at_email.com  \n",
       "6         zoe@mail.com  \n",
       "7        tom.email.com  \n",
       "8       john.doe@gmail  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#STEP 10\n",
    "\n",
    "# Normalize Delivery Status column\n",
    "\n",
    "df_clean['Delivery_Status'] = df_clean['Delivery_Status'].str.strip().str.lower().str.capitalize()\n",
    "df_clean\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>3</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-03-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.50</td>\n",
       "      <td>15.50</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>Pending</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>Female</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55.00</td>\n",
       "      <td>110.00</td>\n",
       "      <td>2024-01-13</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.00</td>\n",
       "      <td>500.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category  Quantity  \\\n",
       "0         1      John Doe    Male  34.0      Electronics         2   \n",
       "1         2    Jane Smith  Female  28.0         Clothing         3   \n",
       "2         3           Sam    Male  31.0           Beauty         1   \n",
       "3         4           Ali  Female  45.0          Kitchen         0   \n",
       "4         5         Carla  Female  30.0      Electronics         1   \n",
       "5         6          Mike    Male  39.0         Clothing         2   \n",
       "6         7           Zoe  Female  27.0         Clothing         1   \n",
       "7         8           Tom    Male  31.0      Electronics         1   \n",
       "8         9      John Doe    Male  34.0      Electronics         2   \n",
       "9        10         Carla  Female  30.0      Electronics         1   \n",
       "\n",
       "   Price_Per_Unit  Total_Price Purchase_Date Delivery_Status  \\\n",
       "0          499.99       999.98    2024-01-12       Delivered   \n",
       "1           39.99          NaN    2024-03-12       Delivered   \n",
       "2           15.50        15.50    2024-12-01         Pending   \n",
       "3          120.00         0.00    2024-01-12       Cancelled   \n",
       "4          299.00       299.00    2024-01-12       Delivered   \n",
       "5           55.00       110.00    2024-01-13       Delivered   \n",
       "6           29.99        29.99    2024-01-12       Delivered   \n",
       "7          500.00       500.00    2024-01-12       Delivered   \n",
       "8          499.99       999.98    2024-01-12       Delivered   \n",
       "9          299.00       299.00    2024-01-12       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0                  NaN  \n",
       "1  jane.smith@mail.com  \n",
       "2                  NaN  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5                  NaN  \n",
       "6         zoe@mail.com  \n",
       "7                  NaN  \n",
       "8                  NaN  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#STEP 11\n",
    "\n",
    "# Normalize Email column\n",
    "\n",
    "def clean_email(email):\n",
    "    if pd.isnull(email):\n",
    "        return np.nan\n",
    "\n",
    "    email = str(email).strip().lower()\n",
    "    \n",
    "    if '@' not in email or '.' not in email.split('@')[-1]:\n",
    "        return np.nan\n",
    "\n",
    "    return email\n",
    "\n",
    "df_clean['Email'] = df_clean['Email'].apply(clean_email)\n",
    "df_clean\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category  Quantity  \\\n",
       "0         1      John Doe    Male  34.0      Electronics         2   \n",
       "4         5         Carla  Female  30.0      Electronics         1   \n",
       "8         9      John Doe    Male  34.0      Electronics         2   \n",
       "9        10         Carla  Female  30.0      Electronics         1   \n",
       "\n",
       "   Price_Per_Unit  Total_Price Purchase_Date Delivery_Status            Email  \n",
       "0          499.99       999.98    2024-01-12       Delivered              NaN  \n",
       "4          299.00       299.00    2024-01-12       Delivered  carla@gmail.com  \n",
       "8          499.99       999.98    2024-01-12       Delivered              NaN  \n",
       "9          299.00       299.00    2024-01-12       Delivered  carla@gmail.com  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#STEP 12 \n",
    "\n",
    "# Check for duplicate values, ignoring the Order_ID column\n",
    "\n",
    "df_clean[df_clean.drop(columns='Order_ID').duplicated(keep=False)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Order_ID</th>\n",
       "      <th>Customer_Name</th>\n",
       "      <th>Gender</th>\n",
       "      <th>Age</th>\n",
       "      <th>Product_Category</th>\n",
       "      <th>Quantity</th>\n",
       "      <th>Price_Per_Unit</th>\n",
       "      <th>Total_Price</th>\n",
       "      <th>Purchase_Date</th>\n",
       "      <th>Delivery_Status</th>\n",
       "      <th>Email</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jane Smith</td>\n",
       "      <td>Female</td>\n",
       "      <td>28.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>3</td>\n",
       "      <td>39.99</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2024-03-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>jane.smith@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Sam</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Beauty</td>\n",
       "      <td>1</td>\n",
       "      <td>15.50</td>\n",
       "      <td>15.50</td>\n",
       "      <td>2024-12-01</td>\n",
       "      <td>Pending</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Ali</td>\n",
       "      <td>Female</td>\n",
       "      <td>45.0</td>\n",
       "      <td>Kitchen</td>\n",
       "      <td>0</td>\n",
       "      <td>120.00</td>\n",
       "      <td>0.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Cancelled</td>\n",
       "      <td>ali@kitchen.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>Mike</td>\n",
       "      <td>Male</td>\n",
       "      <td>39.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>2</td>\n",
       "      <td>55.00</td>\n",
       "      <td>110.00</td>\n",
       "      <td>2024-01-13</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>Zoe</td>\n",
       "      <td>Female</td>\n",
       "      <td>27.0</td>\n",
       "      <td>Clothing</td>\n",
       "      <td>1</td>\n",
       "      <td>29.99</td>\n",
       "      <td>29.99</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>zoe@mail.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>Tom</td>\n",
       "      <td>Male</td>\n",
       "      <td>31.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>500.00</td>\n",
       "      <td>500.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>John Doe</td>\n",
       "      <td>Male</td>\n",
       "      <td>34.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>2</td>\n",
       "      <td>499.99</td>\n",
       "      <td>999.98</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>Carla</td>\n",
       "      <td>Female</td>\n",
       "      <td>30.0</td>\n",
       "      <td>Electronics</td>\n",
       "      <td>1</td>\n",
       "      <td>299.00</td>\n",
       "      <td>299.00</td>\n",
       "      <td>2024-01-12</td>\n",
       "      <td>Delivered</td>\n",
       "      <td>carla@gmail.com</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Order_ID Customer_Name  Gender   Age Product_Category  Quantity  \\\n",
       "0         1      John Doe    Male  34.0      Electronics         2   \n",
       "1         2    Jane Smith  Female  28.0         Clothing         3   \n",
       "2         3           Sam    Male  31.0           Beauty         1   \n",
       "3         4           Ali  Female  45.0          Kitchen         0   \n",
       "4         5         Carla  Female  30.0      Electronics         1   \n",
       "5         6          Mike    Male  39.0         Clothing         2   \n",
       "6         7           Zoe  Female  27.0         Clothing         1   \n",
       "7         8           Tom    Male  31.0      Electronics         1   \n",
       "8         9      John Doe    Male  34.0      Electronics         2   \n",
       "9        10         Carla  Female  30.0      Electronics         1   \n",
       "\n",
       "   Price_Per_Unit  Total_Price Purchase_Date Delivery_Status  \\\n",
       "0          499.99       999.98    2024-01-12       Delivered   \n",
       "1           39.99          NaN    2024-03-12       Delivered   \n",
       "2           15.50        15.50    2024-12-01         Pending   \n",
       "3          120.00         0.00    2024-01-12       Cancelled   \n",
       "4          299.00       299.00    2024-01-12       Delivered   \n",
       "5           55.00       110.00    2024-01-13       Delivered   \n",
       "6           29.99        29.99    2024-01-12       Delivered   \n",
       "7          500.00       500.00    2024-01-12       Delivered   \n",
       "8          499.99       999.98    2024-01-12       Delivered   \n",
       "9          299.00       299.00    2024-01-12       Delivered   \n",
       "\n",
       "                 Email  \n",
       "0                  NaN  \n",
       "1  jane.smith@mail.com  \n",
       "2                  NaN  \n",
       "3      ali@kitchen.com  \n",
       "4      carla@gmail.com  \n",
       "5                  NaN  \n",
       "6         zoe@mail.com  \n",
       "7                  NaN  \n",
       "8                  NaN  \n",
       "9      carla@gmail.com  "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#STEP 13\n",
    "\n",
    "# Remove duplicate values, ignoring the Order_ID column\n",
    "\n",
    "df_clean = df_clean.drop_duplicates(subset= df_clean.columns.difference(['ID']))\n",
    "df_clean"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "python_course",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
